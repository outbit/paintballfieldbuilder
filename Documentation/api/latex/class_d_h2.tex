\hypertarget{class_d_h2}{
\section{DH2 Class Reference}
\label{class_d_h2}\index{DH2@{DH2}}
}


\href{http://www.weidai.com/scan-mirror/ka.html#DH2}{\tt Unified Diffie-\/Hellman}  


{\ttfamily \#include $<$dh2.h$>$}Inheritance diagram for DH2::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=6cm]{class_d_h2}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_d_h2_ae2ee7e416b765879cb9b8066701baca6}{
{\bfseries DH2} (\hyperlink{class_simple_key_agreement_domain}{SimpleKeyAgreementDomain} \&domain)}
\label{class_d_h2_ae2ee7e416b765879cb9b8066701baca6}

\item 
\hypertarget{class_d_h2_a3d28d61071631a9d2d187c01984fa8de}{
{\bfseries DH2} (\hyperlink{class_simple_key_agreement_domain}{SimpleKeyAgreementDomain} \&staticDomain, \hyperlink{class_simple_key_agreement_domain}{SimpleKeyAgreementDomain} \&ephemeralDomain)}
\label{class_d_h2_a3d28d61071631a9d2d187c01984fa8de}

\item 
\hypertarget{class_d_h2_a8873541aa29f886dc4c38c183e231bac}{
\hyperlink{class_crypto_parameters}{CryptoParameters} \& {\bfseries AccessCryptoParameters} ()}
\label{class_d_h2_a8873541aa29f886dc4c38c183e231bac}

\item 
\hypertarget{class_d_h2_a403d4258cc4c99fb00c921a7e85de660}{
unsigned int \hyperlink{class_d_h2_a403d4258cc4c99fb00c921a7e85de660}{AgreedValueLength} () const }
\label{class_d_h2_a403d4258cc4c99fb00c921a7e85de660}

\begin{DoxyCompactList}\small\item\em return length of agreed value produced \item\end{DoxyCompactList}\item 
\hypertarget{class_d_h2_aed4126a3c1c6dc8c800ca7802e12f8f9}{
unsigned int \hyperlink{class_d_h2_aed4126a3c1c6dc8c800ca7802e12f8f9}{StaticPrivateKeyLength} () const }
\label{class_d_h2_aed4126a3c1c6dc8c800ca7802e12f8f9}

\begin{DoxyCompactList}\small\item\em return length of static private keys in this domain \item\end{DoxyCompactList}\item 
\hypertarget{class_d_h2_ac4f0631532ad65475f53dd3710c6901c}{
unsigned int \hyperlink{class_d_h2_ac4f0631532ad65475f53dd3710c6901c}{StaticPublicKeyLength} () const }
\label{class_d_h2_ac4f0631532ad65475f53dd3710c6901c}

\begin{DoxyCompactList}\small\item\em return length of static public keys in this domain \item\end{DoxyCompactList}\item 
void \hyperlink{class_d_h2_a05de579e63f552a103208bd7fdd23440}{GenerateStaticPrivateKey} (\hyperlink{class_random_number_generator}{RandomNumberGenerator} \&rng, byte $\ast$privateKey) const 
\begin{DoxyCompactList}\small\item\em generate static private key \item\end{DoxyCompactList}\item 
void \hyperlink{class_d_h2_a7151a0d3e0ab520aef0b61c70f59a50a}{GenerateStaticPublicKey} (\hyperlink{class_random_number_generator}{RandomNumberGenerator} \&rng, const byte $\ast$privateKey, byte $\ast$publicKey) const 
\begin{DoxyCompactList}\small\item\em generate static public key \item\end{DoxyCompactList}\item 
void \hyperlink{class_d_h2_aa4a447f81fcdcc656fe4fc5b6e99dc2e}{GenerateStaticKeyPair} (\hyperlink{class_random_number_generator}{RandomNumberGenerator} \&rng, byte $\ast$privateKey, byte $\ast$publicKey) const 
\begin{DoxyCompactList}\small\item\em generate private/public key pair \item\end{DoxyCompactList}\item 
\hypertarget{class_d_h2_adf142bd312b462c1fb1c8c2078fae3fc}{
unsigned int \hyperlink{class_d_h2_adf142bd312b462c1fb1c8c2078fae3fc}{EphemeralPrivateKeyLength} () const }
\label{class_d_h2_adf142bd312b462c1fb1c8c2078fae3fc}

\begin{DoxyCompactList}\small\item\em return length of ephemeral private keys in this domain \item\end{DoxyCompactList}\item 
\hypertarget{class_d_h2_adf9a6b522bd06c40254ceffab14e429c}{
unsigned int \hyperlink{class_d_h2_adf9a6b522bd06c40254ceffab14e429c}{EphemeralPublicKeyLength} () const }
\label{class_d_h2_adf9a6b522bd06c40254ceffab14e429c}

\begin{DoxyCompactList}\small\item\em return length of ephemeral public keys in this domain \item\end{DoxyCompactList}\item 
void \hyperlink{class_d_h2_ab0e10e700f4461005b386a53ca37e7f8}{GenerateEphemeralPrivateKey} (\hyperlink{class_random_number_generator}{RandomNumberGenerator} \&rng, byte $\ast$privateKey) const 
\begin{DoxyCompactList}\small\item\em generate ephemeral private key \item\end{DoxyCompactList}\item 
void \hyperlink{class_d_h2_ab8f69e52f50794ca51774f671cfa45da}{GenerateEphemeralPublicKey} (\hyperlink{class_random_number_generator}{RandomNumberGenerator} \&rng, const byte $\ast$privateKey, byte $\ast$publicKey) const 
\begin{DoxyCompactList}\small\item\em generate ephemeral public key \item\end{DoxyCompactList}\item 
void \hyperlink{class_d_h2_a4b5a84bf47e9a18348521b5a9c752cce}{GenerateEphemeralKeyPair} (\hyperlink{class_random_number_generator}{RandomNumberGenerator} \&rng, byte $\ast$privateKey, byte $\ast$publicKey) const 
\begin{DoxyCompactList}\small\item\em generate private/public key pair \item\end{DoxyCompactList}\item 
bool \hyperlink{class_d_h2_a561ed549ab2f287bd5f72be06e217290}{Agree} (byte $\ast$agreedValue, const byte $\ast$staticPrivateKey, const byte $\ast$ephemeralPrivateKey, const byte $\ast$staticOtherPublicKey, const byte $\ast$ephemeralOtherPublicKey, bool validateStaticOtherPublicKey=true) const 
\begin{DoxyCompactList}\small\item\em derive agreed value from your private keys and couterparty's public keys, return false in case of failure \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{class_d_h2_a37d787f31570d6289d6a3bf9aaeaf185}{
\hyperlink{class_simple_key_agreement_domain}{SimpleKeyAgreementDomain} \& {\bfseries d1}}
\label{class_d_h2_a37d787f31570d6289d6a3bf9aaeaf185}

\item 
\hypertarget{class_d_h2_a6dd273fb685b14e642d272b8a3ea13d4}{
\hyperlink{class_simple_key_agreement_domain}{SimpleKeyAgreementDomain} \& {\bfseries d2}}
\label{class_d_h2_a6dd273fb685b14e642d272b8a3ea13d4}

\end{DoxyCompactItemize}


\subsection{Detailed Description}
\href{http://www.weidai.com/scan-mirror/ka.html#DH2}{\tt Unified Diffie-\/Hellman} 

\subsection{Member Function Documentation}
\hypertarget{class_d_h2_a561ed549ab2f287bd5f72be06e217290}{
\index{DH2@{DH2}!Agree@{Agree}}
\index{Agree@{Agree}!DH2@{DH2}}
\subsubsection[{Agree}]{\setlength{\rightskip}{0pt plus 5cm}bool DH2::Agree (byte $\ast$ {\em agreedValue}, \/  const byte $\ast$ {\em staticPrivateKey}, \/  const byte $\ast$ {\em ephemeralPrivateKey}, \/  const byte $\ast$ {\em staticOtherPublicKey}, \/  const byte $\ast$ {\em ephemeralOtherPublicKey}, \/  bool {\em validateStaticOtherPublicKey} = {\ttfamily true}) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{class_d_h2_a561ed549ab2f287bd5f72be06e217290}


derive agreed value from your private keys and couterparty's public keys, return false in case of failure \begin{DoxyNote}{Note}
The ephemeral public key will always be validated. If you have previously validated the static public key, use validateStaticOtherPublicKey=false to save time. 
\end{DoxyNote}
\begin{DoxyPrecond}{Precondition}
size of agreedValue == \hyperlink{class_d_h2_a403d4258cc4c99fb00c921a7e85de660}{AgreedValueLength()} 

length of staticPrivateKey == \hyperlink{class_d_h2_aed4126a3c1c6dc8c800ca7802e12f8f9}{StaticPrivateKeyLength()} 

length of ephemeralPrivateKey == \hyperlink{class_d_h2_adf142bd312b462c1fb1c8c2078fae3fc}{EphemeralPrivateKeyLength()} 

length of staticOtherPublicKey == \hyperlink{class_d_h2_ac4f0631532ad65475f53dd3710c6901c}{StaticPublicKeyLength()} 

length of ephemeralOtherPublicKey == \hyperlink{class_d_h2_adf9a6b522bd06c40254ceffab14e429c}{EphemeralPublicKeyLength()} 
\end{DoxyPrecond}


Implements \hyperlink{class_authenticated_key_agreement_domain_ac9808fb56eacee0c08a9bbd22fe2c98e}{AuthenticatedKeyAgreementDomain}.\hypertarget{class_d_h2_a4b5a84bf47e9a18348521b5a9c752cce}{
\index{DH2@{DH2}!GenerateEphemeralKeyPair@{GenerateEphemeralKeyPair}}
\index{GenerateEphemeralKeyPair@{GenerateEphemeralKeyPair}!DH2@{DH2}}
\subsubsection[{GenerateEphemeralKeyPair}]{\setlength{\rightskip}{0pt plus 5cm}void DH2::GenerateEphemeralKeyPair ({\bf RandomNumberGenerator} \& {\em rng}, \/  byte $\ast$ {\em privateKey}, \/  byte $\ast$ {\em publicKey}) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{class_d_h2_a4b5a84bf47e9a18348521b5a9c752cce}


generate private/public key pair \begin{DoxyNote}{Note}
equivalent to calling \hyperlink{class_d_h2_ab0e10e700f4461005b386a53ca37e7f8}{GenerateEphemeralPrivateKey()} and then \hyperlink{class_d_h2_ab8f69e52f50794ca51774f671cfa45da}{GenerateEphemeralPublicKey()} 
\end{DoxyNote}


Reimplemented from \hyperlink{class_authenticated_key_agreement_domain_aafe38894865a6f11c3282c8aa94df29e}{AuthenticatedKeyAgreementDomain}.\hypertarget{class_d_h2_ab0e10e700f4461005b386a53ca37e7f8}{
\index{DH2@{DH2}!GenerateEphemeralPrivateKey@{GenerateEphemeralPrivateKey}}
\index{GenerateEphemeralPrivateKey@{GenerateEphemeralPrivateKey}!DH2@{DH2}}
\subsubsection[{GenerateEphemeralPrivateKey}]{\setlength{\rightskip}{0pt plus 5cm}void DH2::GenerateEphemeralPrivateKey ({\bf RandomNumberGenerator} \& {\em rng}, \/  byte $\ast$ {\em privateKey}) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{class_d_h2_ab0e10e700f4461005b386a53ca37e7f8}


generate ephemeral private key \begin{DoxyPrecond}{Precondition}
size of privateKey == PrivateEphemeralKeyLength() 
\end{DoxyPrecond}


Implements \hyperlink{class_authenticated_key_agreement_domain_ab6280d3bf8ad1dd2aa976910b81502f8}{AuthenticatedKeyAgreementDomain}.\hypertarget{class_d_h2_ab8f69e52f50794ca51774f671cfa45da}{
\index{DH2@{DH2}!GenerateEphemeralPublicKey@{GenerateEphemeralPublicKey}}
\index{GenerateEphemeralPublicKey@{GenerateEphemeralPublicKey}!DH2@{DH2}}
\subsubsection[{GenerateEphemeralPublicKey}]{\setlength{\rightskip}{0pt plus 5cm}void DH2::GenerateEphemeralPublicKey ({\bf RandomNumberGenerator} \& {\em rng}, \/  const byte $\ast$ {\em privateKey}, \/  byte $\ast$ {\em publicKey}) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{class_d_h2_ab8f69e52f50794ca51774f671cfa45da}


generate ephemeral public key \begin{DoxyPrecond}{Precondition}
size of publicKey == PublicEphemeralKeyLength() 
\end{DoxyPrecond}


Implements \hyperlink{class_authenticated_key_agreement_domain_a9d1bc83a77f44af6616da42c33b3bc49}{AuthenticatedKeyAgreementDomain}.\hypertarget{class_d_h2_aa4a447f81fcdcc656fe4fc5b6e99dc2e}{
\index{DH2@{DH2}!GenerateStaticKeyPair@{GenerateStaticKeyPair}}
\index{GenerateStaticKeyPair@{GenerateStaticKeyPair}!DH2@{DH2}}
\subsubsection[{GenerateStaticKeyPair}]{\setlength{\rightskip}{0pt plus 5cm}void DH2::GenerateStaticKeyPair ({\bf RandomNumberGenerator} \& {\em rng}, \/  byte $\ast$ {\em privateKey}, \/  byte $\ast$ {\em publicKey}) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{class_d_h2_aa4a447f81fcdcc656fe4fc5b6e99dc2e}


generate private/public key pair \begin{DoxyNote}{Note}
equivalent to calling \hyperlink{class_d_h2_a05de579e63f552a103208bd7fdd23440}{GenerateStaticPrivateKey()} and then \hyperlink{class_d_h2_a7151a0d3e0ab520aef0b61c70f59a50a}{GenerateStaticPublicKey()} 
\end{DoxyNote}


Reimplemented from \hyperlink{class_authenticated_key_agreement_domain_a164d5f09c1af319f4bd4a4d45c4b9309}{AuthenticatedKeyAgreementDomain}.\hypertarget{class_d_h2_a05de579e63f552a103208bd7fdd23440}{
\index{DH2@{DH2}!GenerateStaticPrivateKey@{GenerateStaticPrivateKey}}
\index{GenerateStaticPrivateKey@{GenerateStaticPrivateKey}!DH2@{DH2}}
\subsubsection[{GenerateStaticPrivateKey}]{\setlength{\rightskip}{0pt plus 5cm}void DH2::GenerateStaticPrivateKey ({\bf RandomNumberGenerator} \& {\em rng}, \/  byte $\ast$ {\em privateKey}) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{class_d_h2_a05de579e63f552a103208bd7fdd23440}


generate static private key \begin{DoxyPrecond}{Precondition}
size of privateKey == PrivateStaticKeyLength() 
\end{DoxyPrecond}


Implements \hyperlink{class_authenticated_key_agreement_domain_a00d9b12028e9ecb61af6d0f312965c6f}{AuthenticatedKeyAgreementDomain}.\hypertarget{class_d_h2_a7151a0d3e0ab520aef0b61c70f59a50a}{
\index{DH2@{DH2}!GenerateStaticPublicKey@{GenerateStaticPublicKey}}
\index{GenerateStaticPublicKey@{GenerateStaticPublicKey}!DH2@{DH2}}
\subsubsection[{GenerateStaticPublicKey}]{\setlength{\rightskip}{0pt plus 5cm}void DH2::GenerateStaticPublicKey ({\bf RandomNumberGenerator} \& {\em rng}, \/  const byte $\ast$ {\em privateKey}, \/  byte $\ast$ {\em publicKey}) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{class_d_h2_a7151a0d3e0ab520aef0b61c70f59a50a}


generate static public key \begin{DoxyPrecond}{Precondition}
size of publicKey == PublicStaticKeyLength() 
\end{DoxyPrecond}


Implements \hyperlink{class_authenticated_key_agreement_domain_a853885a901ac7c4f8c51fd177df5d96c}{AuthenticatedKeyAgreementDomain}.

The documentation for this class was generated from the following file:\begin{DoxyCompactItemize}
\item 
C:/Business/C++/Commercial/Paintball Field Builder/Paintball Field Builder v2.0.0/Software Development/Paintball Field Builder/WSKey/cryptopp/inc/\hyperlink{dh2_8h}{dh2.h}\end{DoxyCompactItemize}
